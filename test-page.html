<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Test Page | formJS - JavaScript Form Validation. Made Easy</title>
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="Valerio Di Punzio">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css?family=Expletus+Sans:500|Raleway:200&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/doc.css">
    <link rel="stylesheet" href="css/demo.css">
</head>

<body>
    
    <div class="container mb-5">
        
        <div id="top" class="text-center mb-5">
            <div>
                <p class="mt-5 mb-4">
                    <a href="index.html">&leftarrow; back to documentation</a>
                </p>
            </div>
            <h1>formJS</h1>
            <p>Test Page</p>
        </div>
        
        <!-- Demos -->
        <div id="demos" class="panel-collapsible row justify-content-center">

            <!-- Demo Ajax Form ( POST ) JS Error Messages -->
            <div id="demo-00" class="col-12 col-md-7 col-lg-6 col-xl-5 py-3">
                <div class="panel no-bg">
                    <div class="card-header bg-white text-dark">
                        <div>
                            <p class="m-0">Form</p>
                        </div>
                    </div>
                    <div class="card-body">
                        <form method="POST" action="json/data.json" name="ajax-form-post-js-errors">
                            <div data-formjs-question class="form-group">
                                <div class="answers-box label-move-up">
                                    <input name="name" type="text" data-length="[3,20]" class="form-control" required />
                                    <label>Name</label>
                                </div>
                                <div class="field-error-message small"></div>
                            </div>
                            <div data-formjs-question class="form-group">
                                <div class="answers-box label-move-up">
                                    <input name="email" type="email" class="form-control" required />
                                    <label>Email</label>
                                </div>
                                <div class="field-error-message small"></div>
                            </div>
                            <div data-formjs-question class="form-group">
                                <div class="answers-box label-move-up">
                                    <input name="username" type="text" data-subtype="username" data-async-validation-url="./remoteValidations/username.php" class="form-control" required />
                                    <label>Username</label>
                                </div>
                                <div class="field-error-message small"></div>
                            </div>
                            <div data-formjs-question class="form-group">
                                <div class="answers-box label-move-up">
                                    <input name="password" type="password" class="form-control" required />
                                    <label>Password</label>
                                </div>
                                <div class="field-error-message small"></div>
                            </div>
                            <div data-formjs-question class="form-group">
                                <div class="answers-box label-move-up">
                                    <input name="dateOfBirth" type="date" min="1980-01-11" max="2050-12-30" class="form-control" required />
                                    <label>Date of Birth (type date)</label>
                                </div>
                                <div class="field-error-message small"></div>
                            </div>
                            <div data-formjs-question class="form-group">
                                <div class="answers-box label-move-up">
                                    <input name="dateOfBirth-YYYY-MM-DD" type="text" data-subtype="date" min="1980-01-11" max="2050-12-30" data-date-format="YYYY-MM-DD" class="form-control" required />
                                    <label>Date of Birth (subtype date YYYY-MM-DD)</label>
                                </div>
                                <div class="field-error-message small"></div>
                            </div>
                            <div data-formjs-question class="form-group">
                                <div class="answers-box label-move-up">
                                    <input name="dateOfBirth-YYYY/MM/DD" type="text" data-subtype="date" min="1980-01-11" max="2050-12-30" data-date-format="YYYY MM DD" class="form-control" required />
                                    <label>Date of Birth (subtype date YYYY MM DD)</label>
                                </div>
                                <div class="field-error-message small"></div>
                            </div>
                            <div data-formjs-question class="form-group">
                                <p class="mb-2 small">Select your contact preferences <br />(2 answers max)</p>
                                <div class="answers-box">
                                    <div class="form-check">
                                        <input name="contactPrefCheck" type="checkbox" value="sms" class="form-check-input" id="checkbox-1-a" required="" data-checks="[1,2]" />
                                        <label class="form-check-label" for="checkbox-1-a">SMS</label>
                                    </div>
                                    <div class="form-check">
                                        <input name="contactPrefCheck" type="checkbox" value="email" class="form-check-input" id="checkbox-2-a" required="" />
                                        <label class="form-check-label" for="checkbox-2-a">Email</label>
                                    </div>
                                    <div class="form-check">
                                        <input name="contactPrefCheck" type="checkbox" value="app-notiifcation" class="form-check-input" id="checkbox-3-a" required="" />
                                        <label class="form-check-label" for="checkbox-3-a">App Notification</label>
                                    </div>
                                </div>
                                <div class="field-error-message small">
                                    You must select at least 1 and at most 2 answers!
                                </div>
                            </div>
                            <div data-formjs-question="" class="form-group">
                                <p class="mb-2 small">You must select one of these:</p>
                                <div class="input-container form-check">
                                    <input id="radio-5-20-6-01" name="radio-list-01" value="1" type="radio" class="form-check-input" required />
                                    <label for="radio-5-20-6-01" class="form-check-label">
                                        Answer One
                                    </label>
                                </div>
                                <div class="input-container form-check">
                                    <input id="radio-5-20-6-02" name="radio-list-01" value="2" type="radio" class="form-check-input" required />
                                    <label for="radio-5-20-6-02" class="form-check-label">
                                        Answer Two
                                    </label>
                                </div>
                                <div class="input-group">
                                    <span class="input-group-prepend">
                                        <div class="input-group-text">
                                            <input id="radio-5-200-6-03" name="radio-list-01" value="3" data-require-more="" type="radio" required />
                                            <label for="radio-5-200-6-03">&nbsp;Other:</label>
                                        </div>
                                    </span>
                                    <input class="form-control" name="radio-list-01-more" data-required-from="#radio-5-200-6-03" type="text" />
                                </div>
                                <div class="field-error-message small">You must choose an answer ( and fill the text field if you selected "Other" )!</div>
                            </div>
                            <div data-formjs-question class="form-group">
                                <div class="answers-box">
                                    <div class="small">
                                        I agree with the <a href="#" target="_blank">Privacy Policy</a>.
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="privacyCheck" id="privacyCheck-1-a" value="accepted" required />
                                        <label class="form-check-label" for="privacyCheck-1-a">Yes</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="privacyCheck" id="privacyCheck-2-a" value="" required />
                                        <label class="form-check-label" for="privacyCheck-2-a">No</label>
                                    </div>
                                </div>
                                <div class="field-error-message small">You must agree!</div>
                            </div>
                            <div class="text-center">
                                <button type="submit" class="btn btn-light">SEND</button>
                            </div>
                            <div class="d-none alert mt-5 mb-4" role="alert" data-formjs-global-feedback></div>
                        </form>
                    </div>
                </div>
            </div>
            
        </div>
        
    </div>

    <!-- DYNAMICALLY LOAD POLYFILLS -> REQUIRED TO SUPPORT IE 10/11 AND SOME EDGE VERSIONS -->
    <script src="https://cdn.polyfill.io/v3/polyfill.min.js?features=Array.from,Element.prototype.closest,Element.prototype.matches,Promise,Promise.prototype.finally,AbortController,fetch,CustomEvent"></script>
    <script src="js/include.js"></script>
    <script src="dist/formjs.js"></script>
    <script src="dist/additionals/validationRules.js"></script>
    <script src="dist/additionals/validationErrors.js"></script>
    <script>
        function populatePasswords(){
            var pswFields = document.querySelectorAll('form [type="password"]');
            Array.from(pswFields).forEach(function(field){
                field.value = 'asdAsd123';
            });
        }

        populatePasswords();

        document.querySelector('.card-header').click();
        
        var formEl = document.querySelector('form');
        var options = {
            fieldOptions: {
                // onValidationCheckAll: false,
                beforeValidation: [
                    function beforeValidation_testPage1( fieldObj ){
                        console.log('--- beforeValidation_testPage 1 fieldObj', fieldObj);
                    },
                    /* function beforeValidation_testPage2( fieldObj ){
                        console.log('--- beforeValidation_testPage2 fieldObj', fieldObj);
                        return new Promise(function(resolve){
                            setTimeout(function(){
                                resolve( fieldObj );
                            }, 1000);
                        });
                    }, */
                    /* function beforeValidation_testPage3( fieldObj ){
                        console.log('--- beforeValidation_testPage 3 fieldObj', fieldObj);
                        fieldObj.aaa = 'ciao';
                        return fieldObj;
                    } */
                ]
            },
            formOptions: {
                beforeSend: [
                    function beforeSendTest ( data ){
                        console.log('beforeSendTest data', data);

                        var feedbackEl = this.formEl.querySelector('[data-formjs-global-feedback]');
                        if( feedbackEl ){
                            feedbackEl.classList.add( 'd-none' );
                        }
                        //data.stopExecution = true;

                        return Promise.resolve(data);
                    },
                    /* function beforeSendTest_2 (data){
                        console.log('beforeSend additional');
                        data.formData.prova = 'ciao';
                        //data.stopExecution = true;
                        return data;
                        //return Promise.resolve(data);
                    }, */
                    /* function beforeSendTest_3 (data){
                        console.log('beforeSend additional 2');
                        return Promise.all( [1, 2, 3].map(function( fieldEl ){
                            return new Promise(resolve => {
                                setTimeout(function(){
                                    fieldEl = fieldEl + 1;
                                    resolve({fieldEl: fieldEl});
                                }, 3000);
                            });
                        }) ).then(list => {

                            console.log('beforeSendTest_3 list', list);
                            return data;

                        });
                    } */
                ]
            }
        };

        // DECOMMENT TO TEST LITE VERSION
        // delete options.formOptions;

        formEl.addEventListener('fjs.field:validation', function(e){
            console.log('--- GENERAL FIELD VALIDATION', this);
            console.log(e.type, e.detail);
            console.log('--- FIELD IS ' + (e.detail.result ? '' : 'NOT ') + 'VALID');
        }, false);

        formEl.querySelector('[type="email"]').addEventListener('fjs.field:validation', function(e){
            console.log('--- SPECIFIC FIELD VALIDATION ( EMAIL )', this);
            console.log(e.type, e.detail);
            console.log('--- FIELD IS ' + (e.detail.result ? '' : 'NOT ') + 'VALID');
        }, false);

        formEl.addEventListener('fjs.form:validation', function(e){
            console.log(e.type, e.detail);
            console.log('--- FORM IS ' + (e.detail.result ? '' : 'NOT ') + 'VALID');
        }, false);

        formEl.addEventListener('fjs.form:submit', function(e){
            console.log(e.type, e.detail);
            e.detail
                .then(function(response){
                    console.log(e.type, 'then', response);
                })
                .catch(function(error){
                    console.log(e.type, 'catch', error);
                })
                .finally(function(){
                    console.log(e.type, 'finally');
                });
        }, false);

        // DECOMMENT TO TEST LITE VERSION
        /* formEl.addEventListener('submit', function(e){
            e.preventDefault();
            formInstance.validateForm().then(function(obj){
                console.log('form validation', obj);
            });
        }); */

        var formInstance = new Form( formEl, options );
    </script>
    <script src="dist/additionals/utils.js"></script>
    
</body>
</html>